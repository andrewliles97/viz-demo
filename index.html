<!DOCTYPE html>
<html lang="en">
	<head>
		<title>viz-demo</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #000;
				margin: 0px;
				overflow: hidden;
			}
			#info {
				position: absolute;
				color: #fff;
				top: 0px;
				width: 100%;
				padding: 5px;
				text-align:center;
			}
			a {
				color: #fff;
			}
		</style>
	</head>
	<body>

		<script src="build/three.js"></script>
		<script src="js/controls/OrbitControls.js"></script>
		<script src="js/QuickHull.js"></script>
		<script src="js/geometries/ConvexGeometry.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/libs/stats.min.js"></script>

		<script>

			if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

			var group, camera, scene, renderer;

			init();
			animate();

			function init() {

				scene = new THREE.Scene();

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );

				// camera

				camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 20000 );
				camera.position.set( 25, 30, 40 );
				scene.add( camera );

				// controls

				var controls = new THREE.OrbitControls( camera, renderer.domElement );
				controls.minDistance = 2;
				controls.maxDistance = 200;
				controls.maxPolarAngle = Math.PI / 2;

				scene.add( new THREE.AmbientLight( 0x222222 ) );

				// light

				var light = new THREE.PointLight( 0xffffff, 1 );
				camera.add( light );

				// helper

				scene.add( new THREE.AxesHelper( 50 ) );

				// textures

				var loader = new THREE.TextureLoader();
				var texture = loader.load( 'textures/sprites/disc.png' );

				group = new THREE.Group();
				scene.add( group );

				// points
				//hull = [[-64933.37720195445, -37555.168146896256, 300.0002609061291], [64966.62279804555, -37555.168146896256, 300.0002609061291], [65124.976821496064, -37509.326083525266, 300.00240388755174], [65799.97682149606, -36384.326083525266, 300.00240388755174], [66699.97682149606, -34734.326083525266, 300.00240388755174], [68124.97682149606, -31809.326083525262, 300.00240388755174], [68874.97682149606, -30159.326083525262, 300.00240388755174], [69474.97682149606, -28734.326083525262, 300.00240388755174], [69999.97682149606, -27459.326083525262, 300.00240388755174], [70524.97682149606, -26034.32608352526, 300.00240388755174], [71499.97682149606, -23334.326083525262, 300.00240388755174], [72774.97682149606, -18984.326083525262, 300.00240388755174], [73599.97682149606, -15459.326083525264, 300.00240388755174], [73899.97682149606, -13884.326083525264, 300.00240388755174], [74049.97682149606, -12909.326083525262, 300.00240388755174], [74799.97682149606, -7809.326083525263, 300.00240388755174], [74949.97682149606, -6159.326083525263, 300.00240388755174], [75024.97682149606, -5109.326083525263, 300.00240388755174], [75174.97682149606, -1434.3260835252631, 300.00240388755174], [75174.97682149606, 2240.673916474737, 300.00240388755174], [75024.97682149606, 4940.673916474737, 300.00240388755174], [74874.97682149606, 6965.673916474737, 300.00240388755174], [74574.97682149606, 9590.673916474736, 300.00240388755174], [74349.97682149606, 11165.673916474736, 300.00240388755174], [74199.97682149606, 12140.673916474736, 300.00240388755174], [73899.97682149606, 13715.673916474736, 300.00240388755174], [73299.97682149606, 16715.673916474738, 300.00240388755174], [73074.97682149606, 17690.673916474738, 300.00240388755174], [72549.97682149606, 19715.673916474738, 300.00240388755174], [72174.97682149606, 21140.673916474734, 300.00240388755174], [72160.10379167441, 21193.95531932487, 300.00215876242794], [71410.10379167441, 23593.955319324872, 300.00215876242794], [70435.10379167441, 26368.955319324872, 300.00215876242794], [69535.10379167441, 28618.955319324872, 300.00215876242794], [68185.10379167441, 31618.955319324872, 300.00215876242794], [66985.10379167441, 34168.95531932487, 300.00215876242794], [66310.10379167441, 35443.95531932487, 300.00215876242794], [65485.1037916744, 36943.95531932487, 300.00215876242794], [64810.1037916744, 38143.95531932487, 300.00215876242794], [-64489.8962083256, 38143.95531932487, 300.00215876242794], [-64650.0, 38100.0, 300.0], [-65325.0, 36900.0, 300.0], [-66150.0, 35400.0, 300.0], [-66825.0, 34125.0, 300.0], [-68025.0, 31575.0, 300.0], [-69375.0, 28575.0, 300.0], [-70275.0, 26325.0, 300.0], [-71250.0, 23550.0, 300.0], [-72000.0, 21149.999999999996, 300.0], [-72375.0, 19725.0, 300.0], [-72900.0, 17700.0, 300.0], [-73125.0, 16725.0, 300.0], [-73725.0, 13725.0, 300.0], [-74025.0, 12150.0, 300.0], [-74175.0, 11175.0, 300.0], [-74400.0, 9600.0, 300.0], [-74700.0, 6975.0, 300.0], [-74850.0, 4950.0, 300.0], [-75000.0, 2250.0, 300.0], [-75000.0, -1425.0, 300.0], [-74850.0, -5100.0, 300.0], [-74775.0, -6150.0, 300.0], [-74625.0, -7800.0, 300.0], [-73875.0, -12899.999999999998, 300.0], [-73725.0, -13875.0, 300.0], [-73425.0, -15450.0, 300.0], [-72600.0, -18975.0, 300.0], [-71325.0, -23325.0, 300.0], [-71308.37720195444, -23380.168146896252, 300.0002609061291], [-70333.37720195444, -26080.16814689625, 300.0002609061291], [-69808.37720195444, -27505.168146896252, 300.0002609061291], [-69283.37720195444, -28780.168146896252, 300.0002609061291], [-68683.37720195444, -30205.168146896252, 300.0002609061291], [-67933.37720195444, -31855.168146896252, 300.0002609061291], [-66508.37720195444, -34780.168146896256, 300.0002609061291], [-65608.37720195444, -36430.168146896256, 300.0002609061291], [0.0, 0.0, 0.0], [160.10379167440544, 43.95531932487389, 0.0021587624279462148], [174.97682149606698, -9.326083525263144, 0.0024038875517167213], [16.622798045552024, -55.16814689625308, 0.00026090612906415345]];
				hull = [[-778.0351563928514, -505.2302858040302, 3.99662696236264], [953.4106648912433, -506.05390691624365, 4.0032071310830855], [954.2035816941301, -504.68145118202955, 3.9971490106115692], [962.7958491781837, -489.4760706530371, 3.9953293889962502], [974.6396448265285, -467.43625599774856, 3.994705503888156], [993.8282507944093, -428.6024237590803, 3.995673620909266], [1003.7829833417306, -406.6191754986795, 3.9955366894835462], [1011.8538673422992, -387.6802367422031, 3.9958923234016814], [1018.7209206253495, -370.6543420735631, 3.9953618545354717], [1025.9210613810246, -351.75992628908705, 3.9962579592090854], [1038.4806322931806, -315.66599027142234, 3.994475494671148], [1055.4789703158579, -257.7708647391956, 3.9945869728984658], [1066.5269135578158, -210.86273909398224, 3.9948570893426623], [1070.6949711656785, -189.92895139016582, 3.995566010377972], [1073.0369072513242, -177.0074839614507, 3.9969644249942844], [1082.506539931132, -109.0255713587801, 3.9948775092771345], [1084.5559318275393, -87.06478629971751, 3.9950881538006167], [1085.6062412022188, -73.08978536499228, 3.9952957000092533], [1087.7367822833264, -24.164921653969714, 3.995829099637463], [1087.4708958410763, 24.76106476275453, 3.9947667826310345], [1085.7470133899665, 60.72097988508955, 3.9958592640196224], [1083.602075320504, 87.67102307295664, 3.9952671028948163], [1079.7218513752807, 122.63358218916264, 3.9957255252869865], [1076.7926945281486, 143.61476297448837, 3.9959950620777454], [1074.7535252677635, 156.59092841713309, 3.995825928381998], [1071.0759837498838, 177.6215381504695, 3.997114595334141], [1062.8152519762755, 217.51904134148853, 3.9960125335345436], [1059.7621736739688, 230.4882949319165, 3.995778304955169], [1052.8223490767798, 257.46533543303536, 3.99598799851342], [1047.4861993507063, 276.3399503826428, 3.994561833646323], [1047.2786939728812, 277.0463835574394, 3.9945189083253707], [1037.2979776503435, 308.9936248633178, 3.9945295692077933], [1024.274263777691, 345.91471059759, 3.9943357308198206], [1012.4643773237281, 375.93293779979706, 3.995067793224754], [994.8892039595297, 416.0558641782429, 3.9968174224766293], [978.449442844614, 449.7848113269161, 3.9947663619749165], [969.5487968922039, 466.80280290355927, 3.9951506902033143], [958.5646115990411, 486.77197081889403, 3.995146690129845], [949.4036742869274, 502.6447696397094, 3.9943373866766647], [-773.0552828403675, 503.48643386023116, 4.0009561570809975], [-773.8618240059836, 502.1187113651444, 3.9947731900638384], [-783.014125385971, 486.2384498640628, 3.9955378928880054], [-793.9871268002362, 466.26058630086715, 3.9954860085470725], [-802.8780217921715, 449.2357226059691, 3.9950543833541823], [-819.2981862593929, 415.49405924656526, 3.9970130621865407], [-836.8491096702437, 375.35879011181896, 3.995154749663838], [-848.6405270368369, 345.3327757276199, 3.99434263187534], [-861.6412624914711, 308.40370310201075, 3.994439307445685], [-871.6018823687307, 276.451103313053, 3.9943456563666953], [-876.9399756573569, 257.57799829542125, 3.995780792133897], [-883.8826742142353, 230.60290553189267, 3.995584175652145], [-886.9371622825593, 217.63453589811928, 3.9958246744770163], [-895.2023418626337, 177.73951019284132, 3.9969460585016536], [-898.8822995398152, 156.7099963975437, 3.9956677499715507], [-900.9229734534629, 143.73448221189352, 3.995843213488194], [-903.8545936228229, 122.75425153674738, 3.995583964996802], [-907.7389899472029, 87.79303652552207, 3.9951427278685956], [-909.887191000235, 60.84385395082896, 3.995748124923225], [-911.6154835720732, 24.88475077590934, 3.994673442848238], [-911.8874361776154, -24.040565851480302, 3.9957599751074713], [-909.7629998856662, -72.96540536777128, 3.9952509509731065], [-908.7144348715354, -86.9405111158388, 3.9950503862747704], [-906.6677808339059, -108.90155642299612, 3.9948507278021057], [-897.2065701516068, -176.88496240650835, 3.996971815248995], [-894.8662072186114, -189.80690145699222, 3.995579902280361], [-890.7006886030333, -210.74149567944784, 3.9948815440399734], [-879.6583466222437, -257.6517955994272, 3.9946351913919624], [-862.6666866626357, -315.55037990465934, 3.994553201510703], [-862.4283943363074, -316.2791615394728, 3.9944851468469826], [-849.8454804867594, -352.3651508754995, 3.9961690834826915], [-842.6333632854886, -371.2543710532196, 3.995220926497726], [-835.7555428661, -388.27533287492474, 3.995704098455035], [-827.6728711681878, -407.20813389311814, 3.995295571286254], [-817.704618986631, -429.18365798484524, 3.9953705628966167], [-798.4928294731733, -468.00185230774315, 3.994291913847558], [-786.6361968081485, -490.0319046771963, 3.994852049280375], [0.0, 0.0, 0.0], [160.10379167440544, 43.95531932487389, 0.0021587624279462148], [174.97682149606698, -9.326083525263144, 0.0024038875517167213], [16.622798045552024, -55.16814689625308, 0.00026090612906415345]];
				hull_vecs = hull.map(x => new THREE.Vector3(x[0], x[1], x[2]));

				pointsGeometry = new THREE.Geometry();
				Array.prototype.push.apply(pointsGeometry.vertices, hull_vecs);
				pointsGeometry = pointsGeometry.scale(0.01, 0.01, 0.25).rotateX(-Math.PI/2);

				var pointsMaterial = new THREE.PointsMaterial( {

				color: 0x0080ff,
				map: texture,
				size: 1,
				alphaTest: 0.5

				} );

				var points = new THREE.Points( pointsGeometry, pointsMaterial );
				group.add( points );

				// convex hull

				var meshMaterial = new THREE.MeshLambertMaterial( {
					color: 0xffffff,
					opacity: 0.5,
					transparent: true
				} );
				
				meshGeometry = new THREE.ConvexGeometry(pointsGeometry.vertices);

				var mesh = new THREE.Mesh( meshGeometry, meshMaterial );
				mesh.material.side = THREE.BackSide; // back faces
				mesh.renderOrder = 0;
				group.add( mesh );

				var mesh = new THREE.Mesh( meshGeometry, meshMaterial.clone() );
				mesh.material.side = THREE.FrontSide; // front faces
				mesh.renderOrder = 1;
				group.add( mesh );

				window.addEventListener( 'resize', onWindowResize, false );

			}

			function randomPoint() {

				return new THREE.Vector3( THREE.Math.randFloat( - 1, 1 ), THREE.Math.randFloat( - 1, 1 ), THREE.Math.randFloat( - 1, 1 ) );

			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function animate() {

				requestAnimationFrame( animate );

				//group.rotation.y += 0.005;

				render();

			}

			function render() {

				renderer.render( scene, camera );

			}

		</script>

	</body>
</html>
