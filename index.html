<!DOCTYPE html>
<html lang="en">
	<head>
		<title>viz-demo</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #000;
				margin: 0px;
				overflow: hidden;
			}
			#info {
				position: absolute;
				color: #fff;
				top: 0px;
				width: 100%;
				padding: 5px;
				text-align:center;
			}
			a {
				color: #fff;
			}
		</style>
	</head>
	<body>

		<script src="build/three.js"></script>
		<script src="js/controls/OrbitControls.js"></script>
		<script src="js/QuickHull.js"></script>
		<script src="js/geometries/ConvexGeometry.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/libs/stats.min.js"></script>

		<script>

			if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

			var group, camera, scene, renderer;

			init();
			animate();

			function init() {

				scene = new THREE.Scene();

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );

				// camera

				camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 20000 );
				camera.position.set( 25, 30, 40 );
				scene.add( camera );

				// controls

				var controls = new THREE.OrbitControls( camera, renderer.domElement );
				controls.minDistance = 2;
				controls.maxDistance = 200;
				controls.maxPolarAngle = Math.PI / 2;

				scene.add( new THREE.AmbientLight( 0x222222 ) );

				// light

				var light = new THREE.PointLight( 0xffffff, 1 );
				camera.add( light );

				// helper

				scene.add( new THREE.AxesHelper( 50 ) );

				// textures

				var loader = new THREE.TextureLoader();
				var texture = loader.load( 'textures/sprites/disc.png' );

				group = new THREE.Group();
				scene.add( group );

				// points
				hull = [[-64933.37720195445, -37555.168146896256, 300.0002609061291], [64966.62279804555, -37555.168146896256, 300.0002609061291], [65124.976821496064, -37509.326083525266, 300.00240388755174], [65799.97682149606, -36384.326083525266, 300.00240388755174], [66699.97682149606, -34734.326083525266, 300.00240388755174], [68124.97682149606, -31809.326083525262, 300.00240388755174], [68874.97682149606, -30159.326083525262, 300.00240388755174], [69474.97682149606, -28734.326083525262, 300.00240388755174], [69999.97682149606, -27459.326083525262, 300.00240388755174], [70524.97682149606, -26034.32608352526, 300.00240388755174], [71499.97682149606, -23334.326083525262, 300.00240388755174], [72774.97682149606, -18984.326083525262, 300.00240388755174], [73599.97682149606, -15459.326083525264, 300.00240388755174], [73899.97682149606, -13884.326083525264, 300.00240388755174], [74049.97682149606, -12909.326083525262, 300.00240388755174], [74799.97682149606, -7809.326083525263, 300.00240388755174], [74949.97682149606, -6159.326083525263, 300.00240388755174], [75024.97682149606, -5109.326083525263, 300.00240388755174], [75174.97682149606, -1434.3260835252631, 300.00240388755174], [75174.97682149606, 2240.673916474737, 300.00240388755174], [75024.97682149606, 4940.673916474737, 300.00240388755174], [74874.97682149606, 6965.673916474737, 300.00240388755174], [74574.97682149606, 9590.673916474736, 300.00240388755174], [74349.97682149606, 11165.673916474736, 300.00240388755174], [74199.97682149606, 12140.673916474736, 300.00240388755174], [73899.97682149606, 13715.673916474736, 300.00240388755174], [73299.97682149606, 16715.673916474738, 300.00240388755174], [73074.97682149606, 17690.673916474738, 300.00240388755174], [72549.97682149606, 19715.673916474738, 300.00240388755174], [72174.97682149606, 21140.673916474734, 300.00240388755174], [72160.10379167441, 21193.95531932487, 300.00215876242794], [71410.10379167441, 23593.955319324872, 300.00215876242794], [70435.10379167441, 26368.955319324872, 300.00215876242794], [69535.10379167441, 28618.955319324872, 300.00215876242794], [68185.10379167441, 31618.955319324872, 300.00215876242794], [66985.10379167441, 34168.95531932487, 300.00215876242794], [66310.10379167441, 35443.95531932487, 300.00215876242794], [65485.1037916744, 36943.95531932487, 300.00215876242794], [64810.1037916744, 38143.95531932487, 300.00215876242794], [-64489.8962083256, 38143.95531932487, 300.00215876242794], [-64650.0, 38100.0, 300.0], [-65325.0, 36900.0, 300.0], [-66150.0, 35400.0, 300.0], [-66825.0, 34125.0, 300.0], [-68025.0, 31575.0, 300.0], [-69375.0, 28575.0, 300.0], [-70275.0, 26325.0, 300.0], [-71250.0, 23550.0, 300.0], [-72000.0, 21149.999999999996, 300.0], [-72375.0, 19725.0, 300.0], [-72900.0, 17700.0, 300.0], [-73125.0, 16725.0, 300.0], [-73725.0, 13725.0, 300.0], [-74025.0, 12150.0, 300.0], [-74175.0, 11175.0, 300.0], [-74400.0, 9600.0, 300.0], [-74700.0, 6975.0, 300.0], [-74850.0, 4950.0, 300.0], [-75000.0, 2250.0, 300.0], [-75000.0, -1425.0, 300.0], [-74850.0, -5100.0, 300.0], [-74775.0, -6150.0, 300.0], [-74625.0, -7800.0, 300.0], [-73875.0, -12899.999999999998, 300.0], [-73725.0, -13875.0, 300.0], [-73425.0, -15450.0, 300.0], [-72600.0, -18975.0, 300.0], [-71325.0, -23325.0, 300.0], [-71308.37720195444, -23380.168146896252, 300.0002609061291], [-70333.37720195444, -26080.16814689625, 300.0002609061291], [-69808.37720195444, -27505.168146896252, 300.0002609061291], [-69283.37720195444, -28780.168146896252, 300.0002609061291], [-68683.37720195444, -30205.168146896252, 300.0002609061291], [-67933.37720195444, -31855.168146896252, 300.0002609061291], [-66508.37720195444, -34780.168146896256, 300.0002609061291], [-65608.37720195444, -36430.168146896256, 300.0002609061291], [0.0, 0.0, 0.0], [160.10379167440544, 43.95531932487389, 0.0021587624279462148], [174.97682149606698, -9.326083525263144, 0.0024038875517167213], [16.622798045552024, -55.16814689625308, 0.00026090612906415345]];
				hull_vecs = hull.map(x => new THREE.Vector3(x[0], x[1], x[2]));

				pointsGeometry = new THREE.Geometry();
				Array.prototype.push.apply(pointsGeometry.vertices, hull_vecs);
				pointsGeometry = pointsGeometry.scale(0.0001, 0.0001, 0.025).rotateX(-Math.PI/2);

				var pointsMaterial = new THREE.PointsMaterial( {

				color: 0x0080ff,
				map: texture,
				size: 1,
				alphaTest: 0.5

				} );

				var points = new THREE.Points( pointsGeometry, pointsMaterial );
				group.add( points );

				// convex hull

				var meshMaterial = new THREE.MeshLambertMaterial( {
					color: 0xffffff,
					opacity: 0.5,
					transparent: true
				} );

				console.log(hull_vecs[0]);
				
				meshGeometry = new THREE.ConvexGeometry(pointsGeometry.vertices);

				var mesh = new THREE.Mesh( meshGeometry, meshMaterial );
				mesh.material.side = THREE.BackSide; // back faces
				mesh.renderOrder = 0;
				group.add( mesh );

				var mesh = new THREE.Mesh( meshGeometry, meshMaterial.clone() );
				mesh.material.side = THREE.FrontSide; // front faces
				mesh.renderOrder = 1;
				group.add( mesh );

				window.addEventListener( 'resize', onWindowResize, false );

			}

			function randomPoint() {

				return new THREE.Vector3( THREE.Math.randFloat( - 1, 1 ), THREE.Math.randFloat( - 1, 1 ), THREE.Math.randFloat( - 1, 1 ) );

			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function animate() {

				requestAnimationFrame( animate );

				//group.rotation.y += 0.005;

				render();

			}

			function render() {

				renderer.render( scene, camera );

			}

		</script>

	</body>
</html>
